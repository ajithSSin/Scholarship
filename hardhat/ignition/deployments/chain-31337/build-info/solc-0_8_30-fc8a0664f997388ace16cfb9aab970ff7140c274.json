{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_30-fc8a0664f997388ace16cfb9aab970ff7140c274",
  "solcVersion": "0.8.30",
  "solcLongVersion": "0.8.30+commit.73712a01",
  "userSourceNameMap": {
    "contracts/scholarship.sol": "project/contracts/scholarship.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "prague",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/scholarship.sol": {
        "content": "// SPDX-License-Identifier: MIT\n\npragma solidity 0.8.30;\n\ncontract scholarship {\n    address public admin;\n    uint public scholarshipCounter;\n\n    constructor() {\n        admin = msg.sender;\n    }\n\n    struct Scholarship {\n        uint id;\n        string title;\n        uint256 amount;\n        uint8 minScore;\n        uint8 totalSeats;\n        uint8 requiredAttendance;\n        uint8 requiredAcademic;\n        bool isActive;\n        bool isProcessed;\n    }\n\n    struct Application {\n        address applicant;\n        string studentName;\n        string regNumber;\n        string college;\n        string course;\n        uint8 attendancePercent;\n        uint8 academicMark;\n        uint8 score;\n        bool received;\n    }\n\n    mapping(uint => Scholarship) public scholarships;\n    mapping(uint => Application[]) public scholarshipApplications;\n    mapping(uint => mapping(address => bool)) public hasApplied;\n\n    event ScholarshipCreated(uint id, string title, uint256 amount);\n    event Applied(uint indexed scholarshipId, address indexed student, uint8 score);\n    event Disbursed(uint indexed scholarshipId, address indexed student, uint256 amount);\n\n    modifier onlyAdmin() {\n        require(msg.sender == admin, \"Only admin can perform this action\");\n        _;\n    }\n\n    function addScholarship(\n        string memory _title,\n        uint256 _amount,\n        uint8 _minScore,\n        uint8 _totalSeats,\n        uint8 _requiredAttendance,\n        uint8 _requiredAcademic\n    ) external onlyAdmin {\n        require(_amount > 0, \"Amount must be > 0\");\n        require(_minScore <= 200, \"Invalid min score\");\n        require(_totalSeats > 0, \"Total seats must be > 0\");\n        require(_requiredAttendance <= 100 && _requiredAcademic <= 100, \"Invalid percentage inputs\");\n\n        scholarshipCounter++;\n\n        scholarships[scholarshipCounter] = Scholarship({\n                                                id: scholarshipCounter,\n                                                title: _title,\n                                                amount: _amount,\n            minScore: _minScore,\n            totalSeats: _totalSeats,\n            requiredAttendance: _requiredAttendance,\n            requiredAcademic: _requiredAcademic,\n            isActive: true,\n            isProcessed: false\n        });\n\n        emit ScholarshipCreated(scholarshipCounter, _title, _amount);\n    }\n\n    function applyForScholarship(\n                                uint _scholarshipId,\n                                string memory _studentName,\n                                string memory _regNumber,\n                                string memory _college,\n                                string memory _course,\n                                uint8 _attendancePercent,\n                                uint8 _academicMark\n                            ) external {    \n        Scholarship storage s = scholarships[_scholarshipId];\n\n        require(s.isActive, \"Scholarship not active\");\n        require(!hasApplied[_scholarshipId][msg.sender], \"Already applied\");\n        require(_attendancePercent <= 100 && _academicMark <= 100, \"Invalid input values\");\n        require(_attendancePercent >= s.requiredAttendance, \"Attendance below threshold\");\n        require(_academicMark >= s.requiredAcademic, \"Marks below threshold\");\n\n        uint8 calculatedScore = _attendancePercent + _academicMark;\n\n        scholarshipApplications[_scholarshipId].push(Application({\n                                                                    applicant: msg.sender,\n                                                                    studentName: _studentName,\n                                                                    regNumber: _regNumber,\n                                                                    college: _college,\n                                                                    course: _course,\n                                                                    attendancePercent: _attendancePercent,\n                                                                    academicMark: _academicMark,\n                                                                    score: calculatedScore,\n                                                                    received: false\n                                                                }));\n\n        hasApplied[_scholarshipId][msg.sender] = true;\n        emit Applied(_scholarshipId, msg.sender, calculatedScore);\n    }\n    function getApplicationCount(uint id) \n                                public view returns (uint) {\n        return scholarshipApplications[id].length;\n    }\n\n    function getApplications(uint _scholarshipId) \n                            external view \n                            returns (Application[] memory) {\n        return scholarshipApplications[_scholarshipId];\n    }    \n\n    function selectTopApplicants(uint _scholarshipId) \n                                external onlyAdmin {\n\n        Scholarship storage s = scholarships[_scholarshipId];\n        require(s.isActive, \"Scholarship not active\");\n        require(!s.isProcessed, \"Already processed\");\n\n        Application[] storage apps = scholarshipApplications[_scholarshipId];\n        require(apps.length > 0, \"No applications\");\n\n        for (uint i = 0; i < apps.length; i++) {\n            for (uint j = i + 1; j < apps.length; j++) {\n                if (apps[j].score > apps[i].score) {\n                    Application memory temp = apps[i];\n                    apps[i] = apps[j];\n                    apps[j] = temp;\n                }\n            }\n        }\n\n        uint8 selectedCount = 0;\n        for (uint i = 0; i < apps.length && selectedCount < s.totalSeats; i++) {\n            \n            if (apps[i].score >= s.minScore && !apps[i].received) {\n\n                _disburse(apps[i].applicant, s.amount);\n                apps[i].received = true;\n                selectedCount++;\n                emit Disbursed(_scholarshipId, apps[i].applicant, s.amount);\n            }\n        }\n\n        s.isProcessed = true;\n    }\n\n    function _disburse(address _student, uint256 _amount) internal {\n        require(address(this).balance >= _amount, \"Insufficient contract balance\");\n        (bool sent, ) = _student.call{value: _amount}(\"\");\n        require(sent, \"Transfer failed\");\n    }\n\n    \n\n    function getSelectedApplicants(uint _scholarshipId) \n                                    external view \n                                    returns (Application[] memory) {\n        Application[] storage allApps = scholarshipApplications[_scholarshipId];\n        uint count = 0;\n\n        for (uint i = 0; i < allApps.length; i++) {\n            if (allApps[i].received) count++;\n        }\n\n        Application[] memory selected = new Application[](count);\n\n        uint256 idX = 0;\n        for (uint8 i = 0; i < allApps.length; i++) {\n            if (allApps[i].received) {\n                selected[idX++] = allApps[i];\n            }\n        }\n        return selected;\n    }\n\n    receive() external payable {}\n}\n"
      }
    }
  }
}